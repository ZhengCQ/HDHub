write.table(data2.markers, file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/All_culster_markers.tsv",sep='\t')
features <- c("MYL2")
RidgePlot(data2, features = features, ncol = 2)
features <- c("MYL2","BMP10")
RidgePlot(data2, features = features, ncol = 2)
features
features <- c("MYL2","BMP-10")
RidgePlot(data2, features = features, ncol = 2)
features <- c("MYL2","MYH7")
RidgePlot(data2, features = features, ncol = 2)
features <- c("MYL2","MYL12A")
RidgePlot(data2, features = features, ncol = 2)
features <- c("MYL2","MYL12A","MYH6")
RidgePlot(data2, features = features, ncol = 2)
VlnPlot(pbmc, features = c("MYL2", "MYL12A"))
VlnPlot(data2, features = c("MYL2", "MYL12A"))
VlnPlot(data2, features = c("MYL2", "MYL12A", "MYH6"))
View(data2)
data2@meta.data$nCount_RNA
data2@meta.data$nFeature_RNA
VlnPlot(data2, features = c("GJA1", "TNNT2", "MYH6", "SIRPA"))
VlnPlot(data2, features = c("TNNT2", "MYH6", "ACTN1"))
VlnPlot(data2, features = c("TNNT2", "MYH6", "ACTN1","TNNI3"))
VlnPlot(data2, features = c("TNNT2", "MYH6", "ACTN1","TNNI3","CXA1"))
VlnPlot(data2, features = c("TNNT2", "MYH6", "ACTN1","TNNI3"))
?FindMarkers
FindMarkers(data2,ident.1=5,ident.2 = 6)
makrer5-6 <-FindMarkers(data2,ident.1=5,ident.2 = 6)
makrer56 <-FindMarkers(data2,ident.1=5,ident.2 = 6)
View(makrer56)
View(makrer56)
makrer65 <-FindMarkers(data2,ident.1=6,ident.2 = 5)
View(makrer65)
View(makrer56)
View(makrer65)
View(makrer56)
View(makrer56)
View(makrer65)
View(makrer56)
write.table(marker56,fi)
write.table(marker56,file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/cluster5_vs_6_marker.tsv",sep='\t')
write.table(marker56,file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/cluster5_vs_6_marker.tsv",sep='\t')
marker56
write.table(makrer56,file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/cluster5_vs_6_marker.tsv",sep='\t')
DimPlot(data2, reduction = "tsne")
?DimPlot
DimPlot(data2, reduction = "tsne", label=TRUE)
?DimPlot
DimPlot(data2, reduction = "umap",label=TRUE)
DimPlot(data2, reduction = "tsne", label=TRUE)
package_version('seurat')
package_version('Seurat')
package_version(Seurat)
package_version(seurat)
library('Seurat')
package_version('Seurat')
DimPlot(data2, reduction = "umap",label=TRUE)
View(data2)
head(data2@meta.data()
head(data2@meta.data)
structure(data2)
str(data2)
DimPlot(data2, reduction = "umap",label=TRUE)
?DimPlot
current.cluster.ids
new.cluster.ids <- c('Fibroblasts','NKT cell','Paneth cell','Gamma delta T cells','Fibroblasts','Cardiomyocyte','Cardiomyocyte',\
'NKT cell','Endothelial cells','Macrophages','Mesangial cells','Cardiomyocyte','Neural progenitor cell',\
'Cardiomyocytes')
new.cluster.ids <- c('Fibroblasts','NKT cell','Paneth cell','Gamma delta T cells','Fibroblasts','Cardiomyocyte','Cardiomyocyte',
'NKT cell','Endothelial cells','Macrophages','Mesangial cells','Cardiomyocyte','Neural progenitor cell',
'Cardiomyocytes')
names(new.cluster.ids) <-levels(data2)
data2<-RenameIdents(data2,new.cluster.ids)
DimPlot(data2, reduction = "umap",label=TRUE)
DimPlot(data2, reduction = "umap",label=TRUE,pt.size = 0.5) + NoLegend()
new.cluster.ids<- c('Fibroblasts','NKT','Paneth','Gamma delta T','Fibroblasts','Cardiomyocyte','Cardiomyocyte',
'NKT','Endothelial cells','Macrophages','Mesangial cells','Cardiomyocyte','Neural progenitor',
'Cardiomyocyte')
names(new.cluster.ids) <-levels(data2)
DimPlot(data2, reduction = "umap",label=TRUE,pt.size = 0.5) + NoLegend()
names(new.cluster.ids) <-levels(data2)
data2<-RenameIdents(data2,new.cluster.ids)
DimPlot(data2, reduction = "umap",label=TRUE,pt.size = 0.5) + NoLegend()
new.cluster.ids<- c('Fibroblasts','NKT','Paneth','Gamma delta T','Fibroblasts','Cardiomyocyte','Cardiomyocyte','NKT','Endothelial','Macrophages','Mesangial cells','Cardiomyocyte','Neural progenitor','Cardiomyocyte')
names(new.cluster.ids) <-levels(data2)
data2<-RenameIdents(data2,new.cluster.ids)
DimPlot(data2, reduction = "umap",label=TRUE,pt.size = 0.5) + NoLegend()
range(0,13)
range(0:13)
range([0,13])
range(0,13)
rep(0,13)
1:13
0:13
new.cluster.ids <-0:13
data2<-RenameIdents(data2,new.cluster.ids)
names(new.cluster.ids) <-new.cluster.ids
new.cluster.ids
data2<-RenameIdents(data2,new.cluster.ids)
DimPlot(data2, reduction = "tset",label=TRUE,pt.size = 0.5) + NoLegend()
rm(new.cluster.ids)
DimPlot(data2, reduction = "umap",label=TRUE,pt.size = 0.5) + NoLegend()
data2.markers
data2@meta.data$orig.ident
?RenameIdents
Idents(data2)
0:13
as.charater(0:13)
as.charaters(0:13)
as.charaters(0:13)
as.character
as.charaters(0:13)
as.character(0:13)
Idents(data2)<-as.character(0:13)
DimPlot(data2, reduction = "umap",label=TRUE,pt.size = 0.5) + NoLegend()
data1 <- FindVariableFeatures(data1, selection.method = "vst", nfeatures = 2000)
data2 <- ScaleData(data1, features = all.genes)
data2 <- RunPCA(data2, features = VariableFeatures(object = data2))
DimPlot(data2, dims=c(1,10), reduction = "pca")
DimHeatmap(data2, dims = 1:6, cells = 500, balanced = TRUE)
plot1<-JackStrawPlot(data2, dims = 1:15)
data2 <- JackStraw(data2, num.replicate = 100)
plot1<-JackStrawPlot(data2, dims = 1:15)
data2 <- ScoreJackStraw(data2, dims = 1:20)
plot1<-JackStrawPlot(data2, dims = 1:15)
plot2<-ElbowPlot(data2)
CombinePlots(plots = list(plot1, plot2))
data2 <- FindNeighbors(data2, dims = 1:16)
data2 <- FindClusters(data2, resolution = 0.5)
data2 <- RunUMAP(data2, dims = 1:16)
DimPlot(data2, reduction = "umap")
data2 <- FindClusters(data2, resolution = 0.6)
DimPlot(data2, reduction = "umap")
DimPlot(data2, reduction = "umap",lable=True)
DimPlot(data2, reduction = "umap",lable=TRUE)
DimPlot(data2, reduction = "umap",lables=TRUE)
?DimPlot
DimPlot(data2, reduction = "umap",label=TRUE)
data2 <- RunTSNE(data2, dims = 1:16)
DimPlot(data2, reduction = "tsne",label=TRUE)
data2 <- FindClusters(data2, resolution = 0.5)
DimPlot(data2, reduction = "tsne",label=TRUE)
saveRDS(data2, file="filter_custer.rds")
data2.markers <- FindAllMarkers(data2, only.pos = TRUE, min.pct = 0.25)
write.table(data2.markers, file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/All_culster_markers.tsv",sep='\t')
?write.table
write.table(data2.markers, file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/All_culster_markers.tsv",quote = FALSE,sep='\t')
new.cluster.ids <- c('Fibroblasts','NKT','Paneth','Fibroblasts','NKT','Cardiomyocyte','Cardiomyocyte','Endothelial cells','NTK','Cardiomyocyte','Neural progenitor')
DimPlot(data2, reduction ="umap", group.by ="celltype", label =TRUE,repel =TRUE) + NoLegend()
DimPlot(data2, reduction ="umap", label =TRUE,repel =TRUE) + NoLegend()
current.cluster.ids
data2$orig.ident
DimPlot(data2, reduction ="umap", label =TRUE,repel =TRUE) + NoLegend()
current.cluster.ids
levels(data2)
new.cluster.ids <- c('Fibroblasts','NKT','Paneth','Fibroblasts','NKT','Cardiomyocyte','Cardiomyocyte','Endothelial cells','NTK','Cardiomyocyte','Neural progenitor')
data2@ident
data2 <- FindClusters(data2, resolution = 0.5,save.SNN = TRUE)
data2@ident
data2$orig.ident
new.cluster.ids
names(new.cluster.ids) <-levels(data2)
new.cluster.ids
RenameIdents
?RenameIdents
Idents(data2)
data3 <- RenameIdents(data2, new.cluster.ids)
DimPlot(pbmc, reduction ="umap", label =TRUE, pt.size =0.5) + NoLegend()
DimPlot(data3, reduction ="umap", label =TRUE, pt.size =0.5) + NoLegend()
new.cluster.ids <- c('Fibroblasts','NKT','Paneth','Fibroblasts','NKT','Cardiomyocyte','Cardiomyocyte','Endothelial cells','NKT','Cardiomyocyte','Neural progenitor')
data3 <- RenameIdents(data2, new.cluster.ids)
indet(data2)
indent(data2)
indents(data2)
Indents(data2)
?RenameIdents
Idents(data2)
names(new.cluster.ids) <-levels(data2)
data3 <- RenameIdents(data2, new.cluster.ids)
DimPlot(data3, reduction ="umap", label =TRUE, pt.size =0.5) + NoLegend()
DimPlot(data2, reduction ="umap", label =TRUE, pt.size =0.5) + NoLegend()
DimPlot(data2, reduction ="tsne", label =TRUE, pt.size =0.5) + NoLegend()
DimPlot(data3, reduction ="tsne", label =TRUE, pt.size =0.5) + NoLegend()
DimPlot(data2, reduction ="tsne", label =TRUE, pt.size =0.5) + NoLegend()
data3@meta.data
head(data3@meta.data)
head(data3@active.ident)
new.cluster.ids <- c('Fibroblasts','NKT','Dendritic','Fibroblasts','NKT','Cardiomyocyte','Cardiomyocyte','Endothelial cells','NKT','Cardiomyocyte','Neural progenitor')
names(new.cluster.ids) <-levels(data2)
data3 <- RenameIdents(data2, new.cluster.ids)
DimPlot(data3, reduction ="tsne", label =TRUE, pt.size =0.5) + NoLegend()
head(data3@meta.data)
p1 <- DimPlot(data3, reduction = "tsne", label = TRUE, pt.size = 1.5, label.size=6)
p2 <- DimPlot(data3, reduction = "tsne",  group.by="orig.ident",pt.size = 1.5)
plot_grid(p2,p1)
library(ggplot2)
plot_grid(p2,p1)
library(cowplot)
plot_grid(p2,p1)
DimPlot(data3, reduction = "tsne", label = TRUE, pt.size = 1.5, label.size=6)
DimPlot(data3, reduction = "tsne",  group.by="orig.ident",pt.size = 1.5)
DimPlot(data2, reduction = "tsne",  group.by="orig.ident",pt.size = 1.5)
orig.ident
data2$orig.ident
DimPlot(data2, reduction = "tsne",pt.size = 1.5)
p1 <- DimPlot(data3, reduction = "tsne", label = TRUE, pt.size = 1.5, label.size=6)
p2 <- DimPlot(data3, reduction = "tsne", pt.size = 1.5)
plot_grid(p2,p1)
p1 <- DimPlot(data3, reduction = "tsne", label = TRUE, pt.size = 1.5, label.size=6)
p2 <- DimPlot(data2, reduction = "tsne", pt.size = 1.5)
plot_grid(p2,p1)
data2$orig.ident
data1$orig.ident
data3$orig.ident
Idents(data2)
Idents(data3)
cell.prop <- as.data.frame(prop.table(table(Idents(data3), data3$orig.ident)))
View(cell.prop)
colnames(cell.prop) <- c("cluster","sample","proportion")
plot <- ggplot(cell.prop,aes(sample,proportion,fill=cluster))+
geom_bar(stat="identity",position="fill")+
labs(title="Cell Type Proportion",x="Sample_Name",y="Proportion",fill="Cell Type")+
theme(plot.title = element_text(family="serif",size=15,face="bold",hjust=0.5),
axis.title = element_text(family="serif",size=12,face="bold"),
axis.text = element_text(family="serif",size=10),
legend.text = element_text(family="serif",size=10)
)
plot
ggsave(file=paste(subdir,"/",opt$project,"_Cell_Proportion.pdf",sep=""),plot,width=26,height=12)
ggsave(file=paste('./',"/",opt$project,"_Cell_Proportion.pdf",sep=""),plot,width=26,height=12)
ggsave(file=paste('./',"_Cell_Proportion.pdf",sep=""),plot,width=26,height=12)
ls
View(cell.prop)
write.table(cell.prop, file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/_Cell_Proportion.tsv",sep='\t',quote=False)
write.table(cell.prop, file="/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/_Cell_Proportion.tsv",sep='\t',quote=FALSE)
head(data2@meta.data)
head(data2@meta.data$nFeature_RNA)
head(data2@assays$RNA@counts)
head(data2@assays$RNA)
data3_matrix <- data3@assays$RNA@counts
write.table(data3_matrix,file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell","/","matrix_counts.xls",sep=""), sep="\t", quote=F, row.names=F, col.names=F)#输出文章
write.table(data3_matrix,file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell","/","matrix_counts.xls",sep=""), sep="\t", quote=F)#输出文章
VlnPlot(data2, features = c("MYL2", "MYL12A"))
VlnPlot(data3, features = c("MYL2", "MYL12A"))
VlnPlot(data3, features = c("MYL2", "MYL12A", "MYH7))
VlnPlot(data3, features = c("MYL2", "MYL12A", "MYH7"))
VlnPlot(data3, features = c("MYL2", "MYL12A", "MYH6"))
VlnPlot(data3, features = c("MYL2", "MYL12A"))
head(data3$seurat_clusters)
head(data3$nFeature_RNA)
head(data3$RNA_snn_res.0.5)
head(data2.markers)
FindALLMarkers(data3)
FindAllMarkers(data3)
data3.markers <- FindAllMarkers(data3)
write.tables(data3.markers,file='/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/All_celltype_markers.tsv',sep='\t',quote=FALSE)
write.table(data3.markers,file='/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/All_celltype_markers.tsv',sep='\t',quote=FALSE)
ggsave(file=paste('./',"_Cell_Proportion.pdf",sep=""),plot,width=2,height=6)
ggsave(file=paste('./',"/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/_Cell_Proportion.pdf",sep=""),plot,width=2,height=6)
ggsave(file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/_Cell_Proportion.pdf",sep=""),plot,width=2,height=6)
ls
ggsave(file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/CancerLandscape/左心房粘液瘤/Analysis/SingleCell/_Cell_Proportion.pdf",sep=""),plot,width=4,height=6)
data(data3_matrix)
head(data3_matrix)
head(data3@meta.data)
library(seurat)
library(Seurat)
filter_data<-Read10X('/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A27-filtered_feature_bc_matrix')
data1 <- CreateSeuratObject(counts = filter_data, project = "zou", min.cells = 3, min.features = 200)
head(filter_data)
data1[["percent.mt"]]<-PercentageFeatureSet(data1, pattern = "^MT-")
data1 <- subset(data1, subset = nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)
data1 <- NormalizeData(data1, normalization.method = "LogNormalize", scale.factor = 10000)
data1 <- FindVariableFeatures(data1, selection.method = "vst", nfeatures = 2000)
all.genes <- rownames(data1)
data2 <- ScaleData(data1, features = all.genes)
data2 <- RunPCA(data2, features = VariableFeatures(object = data2))
data2 <- JackStraw(data2, num.replicate = 100)
data2 <- ScoreJackStraw(data2, dims = 1:20)
plot1 <- JackStrawPlot(data2, dims = 1:15)
plot2 <- ElbowPlot(data2)
CombinePlots(plots = list(plot1, plot2))
data2 <- FindNeighbors(data2, dims = 1:16)
data2 <- FindClusters(data2, resolution = 0.5)
data2 <- RunUMAP(data2, dims = 1:16)
DimPlot(data2, reduction = "umap")
data2 <- RunTSNE(data2, dims = 1:16)
DimPlot(data2, reduction = "tsne",label=TRUE)
data2 <- RunTSNE(data2, dims = 1:16)
data2.markers <- FindAllMarkers(data2, only.pos = TRUE, min.pct = 0.25)
DimPlot(data2, reduction = "tsne",label=TRUE)
View(data2.markers)
View(data2.markers)
write.table(file = '/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/All_markers.tsv', data2.markers,sep='\t')
?write.table
write.table(file = '/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/All_markers.tsv', data2.markers,sep='\t',quote=FALSE)
A27_data <- Read10X('/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A27-filtered_feature_bc_matrix')
A36_data <- Read10X('/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A36-filtered_feature_bc_matrix')
A45_data <- Read10X('/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A45-filtered_feature_bc_matrix')
A27_data <- CreateSeuratObject(counts = A27_data, project = "A27", min.cells = 20, min.features = 100)
A36_data <- CreateSeuratObject(counts = A36_data, project = "A36", min.cells = 20, min.features = 100)
A45_data <- CreateSeuratObject(counts = A36_data, project = "A45", min.cells = 20, min.features = 100)
A45_data <- CreateSeuratObject(counts = A45_data, project = "A45", min.cells = 20, min.features = 100)
heart <- merge(A27_data,y = c(A36_data,A45_data), add.cell.ids = c('A27','A36','A45'))
heart[["percent.mt"]] <- PercentageFeatureSet(heart, pattern="^MT-")
tem <- heart@meta.data
p1 <- ggplot(tem,aes(x = nCount_RNA,color=factor(orig.ident),fill=factor(orig.ident)))+geom_density(alpha=0.2,show.legend=F)+scale_x_log10()
library(ggplot2)
p1 <- ggplot(tem,aes(x = nCount_RNA,color=factor(orig.ident),fill=factor(orig.ident)))+geom_density(alpha=0.2,show.legend=F)+scale_x_log10()
p2 <- ggplot(tem,aes(x = nFeature_RNA,color=factor(orig.ident),fill=factor(orig.ident)))+geom_density(alpha=0.2,show.legend=F)+scale_x_log10()
p3 <- ggplot(tem,aes(x = percent.mt,color=factor(orig.ident),fill=factor(orig.ident)))+geom_density(alpha=0.2)+scale_x_log10()
plot <- p1 + p2 + p3
plot
head(tem)
head(PercentageFeatureSet(heart, pattern="^Mt-"))
head(PercentageFeatureSet(heart, pattern="^Mt-"))
heart[["percent.mt"]] <- PercentageFeatureSet(heart, pattern="^Mt-")
tem <- heart@meta.data
head(tem)
p3 <- ggplot(tem,aes(x = percent.mt,color=factor(orig.ident),fill=factor(orig.ident)))+geom_density(alpha=0.2)+scale_x_log10()
plot <- p1 + p2 + p3
plot
ggsave(file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/",opt$project,"_density.pdf",sep=""), plot, width=24, height=8)
ggsave(file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A_heart_density.pdf",sep=""), plot, width=24, height=8)
ggsave(file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A_heart_density.pdf",sep=""), plot, width=12, height=4)
ggsave(file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A_heart_density.pdf",sep=""), plot, width=6, height=2)
ggsave(file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/A_heart_density.pdf",sep=""), plot, width=10, height=4)
ls
heart <- subset(heart, subset= nFeature_RNA > 300 & nCount_RNA > 500  & percent.mt < 15)
heart <- NormalizeData(heart, normalization.method = "LogNormalize", scale.factor = 10000)
heart <- FindVariableFeatures(heart, selection.method = "vst", nfeatures = 2000)
heart <- ScaleData(heart, verbose=FALSE)
heart <- RunPCA(heart, npcs=30, verbose=FALSE)
heart <- RunHarmony(heart, "orig.ident", plot_convergence = TRUE)
heart <- RunHarmony(heart, "orig.ident", plot_convergence = TRUE)
library(harmony)
install.packages('harmony')
library(devtools)
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
library(devtools)
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
export http_proxy=http://127.0.0.1:1085;export https_proxy=http://127.0.0.1:1085;
export http_proxy=http://127.0.0.1:1085;export https_proxy=http://127.0.0.1:1085;
install_github("immunogenomics/harmony")
library(harmony)
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
library(devtools)
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
source('/Users/zhengchq/Database/ieu_gwas_dataset/harmony/R/RunHarmony.R ')
source('/Users/zhengchq/Database/ieu_gwas_dataset/harmony/R/RunHarmony.R')
heart <- RunHarmony(heart, "orig.ident", plot_convergence = TRUE)
source('/Users/zhengchq/Database/ieu_gwas_dataset/harmony/R')
source('/Users/zhengchq/Database/ieu_gwas_dataset/harmony/R/harmony-package.r')
heart <- JackStraw(heart, num.replicate = 100)
install.packages("/Users/zhengchq/Database/ieu_gwas_dataset/harmony")
install.packages("/Users/zhengchq/Database/ieu_gwas_dataset/harmony/R")
install.packages("/Users/zhengchq/Database/ieu_gwas_dataset/harmony/R/harmony-package.r")
less /Users/zhengchq/Database/ieu_gwas_dataset/harmony/R/harmony-package.r
install.packages("/Users/zhengchq/Database/ieu_gwas_dataset/harmony/R/harmony-package.r")
heart <- ScoreJackStraw(heart, dims = 1:20)
plot1 <- JackStrawPlot(heart, dims = 1:15)
plot2 <- ElbowPlot(heart)
CombinePlots(plots = list(plot1, plot2))
data2 <- FindNeighbors(heart, dims = 1:16)
data2 <- FindClusters(data2, resolution = 0.5)
data2 <- RunUMAP(data2, dims = 1:16)
DimPlot(data2, reduction = "umap")
head(data2)
head(heart)
head(heart@meta.data)
DimPlot？
DimPlot?
?DimPlot
DimPlot(data2, reduction = "umap", combine=FALSE)
DimPlot(data2, reduction = "umap", combine=FALSE)
?DimPlot
DimPlot(data2, reduction = "umap", split.by = 'orig.ident', combine=FALSE)
data2 <- RunTSNE(data2, dims = 1:16)
DimPlot(data2, reduction = "tsne",label=TRUE)
data2 <- RunTSNE(data2, dims = 1:16)
DimPlot(data2, reduction = "tsne",label=TRUE,split.by = 'orig.ident')
data2.markers <- FindAllMarkers(data2, only.pos = TRUE, min.pct = 0.25)
head(data2.markers)
write.table(data2.markers, file="/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/All_markers.tsv",sep='\t')
write.table(data2.markers, file="/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell/All_markers.tsv",sep='\t',quote=FALSE)
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
saveRDS(data2,file=paste(/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell_3heart_marker.rds",sep=""))
saveRDS(data2,file=paste("/Users/zhengchq/Documents/PROJECTS/Bio/SpeciGene/CACNA1B/SingleCell_3heart_marker.rds",sep=""))
library(devtools)
library(devtools)
library(devtools)
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
install_github("immunogenomics/harmony")
p.adjust(c(0.01,0.02))
p.adjust(c(0.001219
0.00235,
0.01161,
0.0002321,
0.04407,
0.09028,
0.08871,
0.9854,
0.8959,
0.8695,
0.851,
0.57820.02))
p.adjust(c(0.001219,0.00235,0.01161,0.0002321,0.04407,0.09028,0.08871,0.9854,0.8959,0.8695,0.851,0.5782))
readRDS("/Users/zhengchq/Downloads/新冠死亡_1b496jyk6j9c_beta_se_1.rds")
readRDS('/Users/zhengchq/Documents/PROJECTS/Web/PheoPred/www/back-end/results/1b496jyk6j9c/2020080309270808/beta_se_0.rds')
readRDS('/Users/zhengchq/Documents/PROJECTS/Web/PheoPred/www/back-end/results/1b496jyk6j9c/2020080319162808/beta_se_0.rds')
a<-'0'
is.numeric(a)
is.vector(a)
as.numeric(a)
is.numeric(as.numeric(a))
is.character(as.numeric(a))
attach(leadership)
attach(leadership)
attach('leadership')
gender<-c("男","女","女","男","女","男","女")
age<-c(22,35,27,18,40,55,16)
data.frame(gender,age)
df = data.frame(gender,age)
type(age)
astype(age)
class(age)
class(gender)
class(df)
sort(df$gender)
df[order[gender,age],]
df[order(gender,age),]
new_df = df[order(gender,age),]
new_df = df[order(gender,-age),]
new_df
newsample <-df[sample(1:nrow(df,3, replace=FALSE]
new_df <-df[sample(1:nrow(df,3, replace=FALSE]
new_df <-df[sample(1:nrow(df), 3, replace=FALSE]
new_df <-df[sample(1:nrow(df), 3, replace=FALSE),]
new_df
new_df.shape
new_df.shape()
ncol(new_df)
nrow(new_df)
ncol(df)
nrow(df)
df[!age]
newdf<-df[!age]
newdf
df
df['test'] <-c('0','1','0','1','0','1','1')
df
newdf<-df[!age]
newdf
name(df)
names(df)
names(df) %in% c('age')
!names(df) %in% c('age')
df[!names(df) %in% c('age')]
exit
q()
setwd('~/Documents/PROJECTS/Web/PheoPred/www/back-end/results/12rj0bx6jdlc0/2020081314253008')
read.table('var_com7.tsv')
read.table('var_com10.tsv')
read.table('var_com20.tsv')
read.table('var_com30.tsv')
read.table('var_com30.tsv')
read.table('var_com56.tsv')
read.table('var_com79.tsv')
